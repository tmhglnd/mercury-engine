<!DOCTYPE html>
<html>

<head>
	<title>Mercury Engine Example</title>

	<script src="https://unpkg.com/mercury-engine@1.0.0/dist/mercury.min.es5.js
	"></script>
</head>

<body>
	<button id="b1">start</button>
	<button id="b2">silence</button>

	<script>
		// This script loads the Mercury Engine and allows to insert code
		// from a textarea in the html page
		
		// Include the package from unpkg.com
		const { Mercury } = MercuryEngine;

		// Initialize a Mercury engine with callback function when loaded
		const Engine = new Mercury( () => {
			console.log('The engine and sounds are loaded!');
		});

		// Some mercury code initially created
		const simpleCode = `
			set tempo 110
			set randomSeed 4831
			set scale dorian d

			list progression chordsFromNumerals([I7 IIIm7 IV7 V7])
			new polySynth saw name(chrd)
				set chrd note(progression 1) time(2/1) shape(1 2/1) fx(triggerFilter low 1/1 1/1 4000 100) super(0.132 3)

			list melody add(repeat(flat(progression) 2) [0 12])
			new polySynth saw name(lead)
				set lead note(melody 2) time(1/8) shape(1 2/1) super(0.112 3) gain(0.6) fx(triggerFilter low 1 1/6 5000 100) 
			
			set all fx(squash 1) fx(reverb 0.4 7)

			list drums choose(17 [hat_808 kick_808 snare_808])
			new sample drums time(1/8) gain(0.7) fx(degrade 0.7) fx(delay 3/16 5/16 0.9) timediv([1 1 1 2])
		`

		// evaluate the code on the click of a button
		let b1 = document.getElementById('b1');
		b1.onclick = () => Engine.code({ file: simpleCode });

		// stop the code on the click of a button
		let b2 = document.getElementById('b2');
		b2.onclick = () => Engine.silence();

	</script>
</body>
</html>